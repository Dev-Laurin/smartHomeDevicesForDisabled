{% extends "layout.html" %}
{% block main %}
<div class="container">
	<br> 
	<div class="row">
		<h2> Create a new Device </h2>
	</div>
	<div>
		<form class="needs-validation" action="/createDevice" method="post" novalidate> 
			{{ form.csrf_token }}
			<div class="form-group"> 
				<div class="input-group mb-3">
				  <div class="input-group-prepend">
				    <span class="input-group-text" id="inputGroup-sizing-default">Device Name</span>
				  </div>
				  <input type="text" name="name" class="form-control" aria-label="Sizing example input" aria-describedby="inputGroup-sizing-default" required>
				  <div class="valid-feedback">
				  	Looks good! 
				  </div>
				  <div class="invalid-feedback">
				  	Please provide a device name.  
				  </div>
				</div>
			</div> 
			<div class="form-group">
			    <label for="exampleFormControlTextarea1">Product Description</label>
			    <textarea class="form-control" name="desc" id="exampleFormControlTextarea1" rows="3" required></textarea>
			    <div class="valid-feedback">
			    	Looks good!
			    </div> 
			    <div class="invalid-feedback">
			    	Please provide a device description.
			    </div>
			  </div>
			<div class="input-group mb-3">
			  <div class="input-group-prepend">
			    <span class="input-group-text">$</span>
			  </div>
			  <input name="price" type="text" class="form-control" aria-label="Price" required>
			  <div class="valid-feedback">
			    	Looks good!
			    </div> 
			    <div class="invalid-feedback">
			    	Please provide a price.
			    </div>
			</div>
			 <div class="form-group">
			    <label for="exampleFormControlTextarea1">Describe the rating for this device.</label>
			    <textarea class="form-control" name="narrative" id="exampleFormControlTextarea1" rows="3"></textarea>
			  </div>
			 <div class="input-group mb-3">
			  <div class="input-group-prepend">
			    <span class="input-group-text">Recurring $</span>
			  </div>
			  <input name="recurring_price" value='0' type="text" class="form-control" aria-label="Price" required>
			  <div class="valid-feedback">
			    	Looks good!
			    </div> 
			    <div class="invalid-feedback">
			    	Please provide a reaccurring price. If none put 0.
			    </div>
			</div>
			<div class="input-group mb-3">
			  <div class="input-group-prepend">
			    <label class="input-group-text" for="inputGroupSelect01">Payment Type</label>
			  </div>
			  <select class="custom-select" id="inputGroupSelect01" name="payment_occurence" required>
			    {% for p in po %}
			    	<option value="{{p}}">{{p}}</option>
			    {% endfor %}
			  </select>
			</div>
			<div class="input-group mb-3">
			  <div class="input-group-prepend">
			    <span class="input-group-text" id="inputGroup-sizing-default">Hyperlink to Purchase Device</span>
			  </div>
			  <input type="text" name="link" class="form-control" aria-label="Sizing example input" aria-describedby="inputGroup-sizing-default" required>
			  <div class="valid-feedback">
			    	Looks good!
			    </div> 
			    <div class="invalid-feedback">
			    	Please provide a hyperlink to the device.
			    </div>
			</div>
			<div class="input-group mb-3">
			  <div class="input-group-prepend">
			    <label class="input-group-text" for="inputGroupSelect01">Device Control Category</label>
			  </div>
			  <select class="custom-select" id="inputGroupSelect01" name="device_category" required>
			    {% for d in deviceCat %}
			    	<option value="{{d}}">{{d}}</option>
			    {% endfor %}
			  </select>
			  <div class="valid-feedback">
			    	Looks good!
			  </div> 
			  <div class="invalid-feedback">
			    Please provide a device control input category.
			  </div>
			</div>
			<div class="input-group mb-3">
			  <div class="input-group-prepend">
			    <label class="input-group-text" for="inputGroupSelect01">Device Rating</label>
			  </div>
			  <select name='rating' class="custom-select" id="inputGroupSelect01" required>
			    <option value="1">One</option>
			    <option value="2">Two</option>
			    <option value="3">Three</option>
			    <option value="3">Four</option>
			    <option value="3">Five</option>
			  </select>
			  <div class="valid-feedback">
			    	Looks good!
			    </div> 
			    <div class="invalid-feedback">
			    	Please provide a rating.
			    </div>
			</div>
			<p>Select all categories that apply</p> 
			{% for homecategory in homecategories %}
			<div class="form-check">
			  <input class="form-check-input" type="checkbox" value="{{homecategory.name}}" name="homeCat[]" id="{{homecategory.id}}" required>
			  <label class="form-check-label" for="{{homecategory.id}}">
			    {{homecategory.name}}
			  </label>
			</div>
			{% endfor %}
			<br> 
			<!-- {{ form.recaptcha }} -->
			<br> 
			<button type='submit' class="btn btn-primary">Submit</button> 
		</form> 
		<br> 
	</div>
</div>
<script>

	

	(function() {
	  'use strict';
	  window.addEventListener('load', function() {

	  	//check that at least one device input checkbox is selected
	var requiredCheckboxes = $('.form-check :checkbox[required]'); 
	requiredCheckboxes.change(function(){
		if(requiredCheckboxes.is(':checked')){
			requiredCheckboxes.removeAttr('required'); 
		}
		else {
			requiredCheckboxes.attr('required', 'required'); 
		}
	})

	    // Fetch all the forms we want to apply custom Bootstrap validation styles to
	    var forms = document.getElementsByClassName('needs-validation');
	    // Loop over them and prevent submission
	    var validation = Array.prototype.filter.call(forms, function(form) {
	      form.addEventListener('submit', function(event) {
	        if (form.checkValidity() === false) {
	          event.preventDefault();
	          event.stopPropagation();
	        }
	        form.classList.add('was-validated');
	      }, false);
	    });
	  }, false);
	})();
</script>
{% endblock %}
